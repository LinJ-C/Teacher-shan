<!doctype html>
<html lang="en">
<base href="http://localhost:8080/work-1.0.0/">
<head>
	<script type="text/javascript"  src="${pageContext.request.contextPath}/js/User.js></script>
	<script src="./vendor/jquery/jquery.min.js"></script>
	<script src="./vendor/popper.js/popper.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>防灾科技学院</title>
    <link rel="stylesheet" href="./vendor/simple-line-icons/css/simple-line-icons.css">
    <link rel="stylesheet" href="./vendor/font-awesome/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="./css/styles.css">
</head>
<body class="sidebar-fixed header-fixed">


<!-- 获取后端数据 -->
<script> 
//脚本加载顺序问题
window.onload = function what(){
    var Tname=getCookie("tName");
	document.getElementById("tName").innerText=Tname;
    var years=getCookie("years");
	$("#projectYear").val(years);
	
	 $('#submit').click(function(){ 
		 	var tName=getCookie("tName");		 
		 	var tId=getCookie("tId");
	        var projectYear=document.getElementById('projectYear').value; 
	        var itemId=document.getElementById('itemId').value; 
	        var name=document.getElementById('name').value; 	       	       
	        var jobDescription=document.getElementById('jobDescription').value; 
	        
	        var sTime=document.getElementById('startTime').value; 
	        var eTime=document.getElementById('endTime').value;
	        
	        
	        var stTime=Date(sTime);
	        var enTime=Date(eTime);
			var newstime=new Date(stTime)
			var newetime=new Date(enTime)
            //var time1 = stTime.getTime();
            //var time2 = enTime.getTime();
            
            var startTime=getDateTime(newstime);
            var endTime=getDateTime(newetime);
            
	        //var startTime=$.toJSON(new Date(stTime));
	        //var endTime=$.toJSON(new Date(enTime));
	        
	        
            //,"startTime":startTime,"endTime":endTime,"jobDescription":jobDescription,"itemId":itemId,"projectYear":projectYear,"tName":tName,"tId":tId
	        //"startTime":startTime,"endTime":endTime
	        var submit={"name":name,"tName":tName,"tId":tId,"projectYear":projectYear,"itemId":itemId,"jobDescription":jobDescription,"startTime":startTime,"endTime":endTime}; 	        	        	        	  
	       
	        var jsonData =JSON.stringify(submit);
	        console.log(jsonData);
	        var page="project_submit"; 
	         
	        $.ajax({
	               type:"post",
	               url: page,
	               data:jsonData,
	               dataType:"json",
	               contentType : "application/json;charset=UTF-8",
	               success: function(result){
	            	   alert(result);
	 
	            	   //window.location.href='html/index';

	            	   
	            	   
	               }
	            });
	           //alert("提交成功，请在Tomcat控制台查看服务端接收到的数据");
	        alert("提交成功！");
	    });
	
};
</script> 





<div class="page-wrapper">
    <nav class="navbar page-header">
        <a href="#" class="btn btn-link sidebar-mobile-toggle d-md-none mr-auto">
            <i class="fa fa-bars"></i>
        </a>

        <a class="navbar-brand" href="#">
            <img src="./imgs/logo.png" alt="logo">
        </a>

        <a href="#" class="btn btn-link sidebar-toggle d-md-down-none">
            <i class="fa fa-bars"></i>
        </a>

        <ul class="navbar-nav ml-auto">




            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img src="./imgs/avatar-1.png" class="avatar avatar-sm" alt="logo">
                    <span class="small ml-1 d-md-down-none" id="tName" > </span>
                </a>

                <div class="dropdown-menu dropdown-menu-right">
                    <div class="dropdown-header">更多</div>

                    <a href="#" class="dropdown-item">
                        <i class="fa fa-user"></i> 信息
                    </a>

                    <div class="dropdown-header">Settings</div>

                    <a href="#" class="dropdown-item">
                        <i class="fa fa-wrench"></i> 设置
                    </a>

                </div>
            </li>
        </ul>
    </nav>

    <div class="main-container">
        <div class="sidebar">
            <nav class="sidebar-nav">
                <ul class="nav">
                    <li class="nav-title">Navigation</li>

                    <li class="nav-item">
                        <a href="html/index" class="nav-link ">
                            <i class="icon icon-speedometer"></i>欢迎来到本系统
                        </a>
                    </li>

                                             
					<li class="nav-item ">
                        <a href="html/declare" class="nav-link active">
                            <i class="icon icon-target"></i> 申报工作量 
                        </a>
                    </li>

                    <li class="nav-item ">
                        <a href="html/scan" class="nav-link ">
                            <i class="icon icon-energy"></i> 查看工作量
                        </a>
                    </li>

                    <li class="nav-item ">
                        <a href="html/publicity" class="nav-link ">
                            <i class="icon icon-graph"></i> 查看公示
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header bg-light">
                                Basic Forms
                            </div>

                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="disabled-input" id="year" class="form-control-label">当前工作季度</label>
                                            <input id="projectYear" class="form-control" value="" disabled>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                       <div class="form-group">
                                            <label for="single-select">指标选择</label>
                                            <select id="itemId" class="form-control">
                                                <option>1</option>
                                                <option>2</option>
                                                <option>3</option>
                                                <option>4</option>
                                                <option>5</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-4">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="placeholder-input" class="form-control-label">项目名称</label>
                                            <input id="name" class="form-control" placeholder="Project Name">
                                        </div>
                                    </div>

                                </div>

							<div style="width:1500px">
                                <div class="row mt-4">
									<div class="col-md-6">
									<label for="single-select">主要工作</label>
 									<textarea id="jobDescription" class="" style="width:95%"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row mt-4">
								
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="single-select">项目开始时间</label>
                                            <input id="startTime" class="form-control" placeholder="年/月/日">
                                        </div>
                                        
                                    </div>
										<div class="col-md-4">
                                        <div class="form-group">
                                            <label for="single-select">项目结束时间</label>                                                                                   
                                            <input id="endTime" class="form-control" placeholder="年/月/日">
                                        </div>
                                    </div>

                                </div>
                                <br>                                                             
                                <button id="submit" type="button" class="btn btn-block btn-success">提交</button>
							
</div>
								

                            </div>
                        </div>
                    </div>
                </div>
    </div>
</div>

<script type="text/javascript">
//cookie函数

   

//写入cookie
function SetCookie(name, value) {
            var exp = new Date();
            exp.setTime(exp.getTime() + 5*60* 1000); //5分钟过期
            document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString();
            return true;
        };
//读取cookie
function getCookie(name) {
            var arr = document.cookie.match(new RegExp("(^| )" + name + "=([^;]*)(;|$)"));
            if (arr != null) return unescape(arr[2]); return null;
        };

        function getDateTime(date) {

        	    var year = date.getFullYear();

        	    var month = date.getMonth() + 1;

        	    var day = date.getDate();

        	    var hh = date.getHours();

        	    var mm = date.getMinutes();

        	    var ss = date.getSeconds();

        	    return year + "-" + month + "-" + day + " " + hh + ":" + mm + ":" + ss; 
        	}
//日期格式处理
        function getDateTime(date) {
 		    var year = date.getFullYear();
 		    var month = date.getMonth() + 1;
 		    var day = date.getDate();
 		    var hh = date.getHours();
 		    var mm = date.getMinutes();
 		    var ss = date.getSeconds();
 		    return year + "-" + month + "-" + day + " " + hh + ":" + mm + ":" + ss; 
        		}
        		
</script>

<script src="./vendor/jquery/jquery.min.js"></script>
<script src="./vendor/popper.js/popper.min.js"></script>
<script src="./vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="./vendor/chart.js/chart.min.js"></script>
<script src="./js/carbon.js"></script>
<script src="./js/demo.js"></script>
</body>
</html>
